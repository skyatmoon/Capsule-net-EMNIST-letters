import torch
import numpy as np

def one_hot(x, class_count):
    return torch.eye(class_count)[x,:]
n = 27  #类别数
indices = torch.randint(0, n, size=(1,100))  #生成数组元素0~5的二维数组（15*15）
print(indices)
one_hot = torch.nn.functional.one_hot(indices, -1)  #size=(15, 15, n)
print(one_hot.size())
#indices[0] = [13, 4, 23,  3, 11, 11, 14, 10, 10, 14,  3,  8, 21,  1, 17,  9,  9,  4,11,  2, 18,  1, 13, 26, 26,  5, 17, 10, 22, 17, 15,  1,  4, 13, 16, 20,25,  8,  9,  3, 17, 23, 19, 15,  7,  3, 24,  4, 12, 24, 14,  1, 19,  4,24, 26, 11, 20, 22, 15,  2, 23,  7, 13, 14,  4,  2,  4, 10,  6, 24, 26,11, 13, 19, 22,  9, 25, 23,  2, 16, 13, 19, 17,  3,  3, 22,  8, 25,  8,13,  4, 26, 21, 18,  4, 23,  7, 14, 10]
x = [13, 4, 23,  3, 11, 11, 14, 10, 10, 14,  3,  8, 21,  1, 17,  9,  9,  4,11,  2, 18,  1, 13, 26, 26,  5, 17, 10, 22, 17, 15,  1,  4, 13, 16, 20,25,  8,  9,  3, 17, 23, 19, 15,  7,  3, 24,  4, 12, 24, 14,  1, 19,  4,24, 26, 11, 20, 22, 15,  2, 23,  7, 13, 14,  4,  2,  4, 10,  6, 24, 26,11, 13, 19, 22,  9, 25, 23,  2, 16, 13, 19, 17,  3,  3, 22,  8, 25,  8,13,  4, 26, 21, 18,  4, 23,  7, 14, 10]
indices[0] = torch.tensor(x)
print(indices)
one_hot = torch.nn.functional.one_hot(indices, n)  #size=(15, 15, n)
print(one_hot)